{% block head %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>



<!--FIREBASE-->
<script defer src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/7.14.6/firebase-database.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/7.14.6/firebase-auth.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/7.14.6/firebase-firestore.js"></script>
<!--LEAFLET-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
<!--JQUERY UI-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
<!--OWN JS-->
<script defer src="{{ url_for('static', filename='scripts/handleReports.js') }}?{{ cache }}"></script>
{% endblock head %}
{% block content %}
  <div class="container" style="overflow-y: auto;">
    <div class="row" style="overflow-x: auto;">      
      <div class="btn-group btn-group-toggle" data-toggle="buttons">
        <!--
          Aqui se muestran los tipos de violencia
          las opciones deben llevar los attr-id asi como esta ahi y
          la clase chooseViolence que es para manejar el evento del click cuando seleccionen uno
        -->
        {% for violence in violences.values()|sort(attribute='name') %}
          <label class="btn btn-secondary">
            <input type="radio" name="options" attr-id="{{ violence.idAlerttype }}" autocomplete="off" class="chooseViolence"> {{ violence.name }}
          </label>
        {% endfor %}
      </div>
    </div>
  
    <hr>
  
    <div class="row" style="overflow-x: auto;">
      <div class="btn-group btn-group-toggle" data-toggle="buttons">
        <!--
          Aqui se muestran los tipos de agresores
          las opciones deben llevar los attr-id asi como esta ahi y
          la clase chooseAgressor que es para manejar el evento del click cuando seleccionen uno
        -->
        {% for aggressor in aggressors.values()|sort(attribute='name') %}
          <label class="btn btn-secondary">
            <input type="radio" name="options" attr-id="{{ aggressor.idAggressor }}" autocomplete="off" class="chooseAgressor"> {{ aggressor.name }}
          </label>
        {% endfor %}
      </div>
    </div>
  
    <hr>
  
    <div class="row" style="overflow-x: auto;">
      <div class="btn-group btn-group-toggle" data-toggle="buttons">
        <!--
          Aqui se muestran los grupos del colectivo
          las opciones deben llevar los attr-id asi como esta ahi y
          la clase chooseCollective que es para manejar el evento del click cuando seleccionen uno
        -->
        {% for collective in collectives.values()|sort(attribute='name') %}
          <label class="btn btn-secondary">
            <input type="radio" name="options" attr-id="{{ collective.idCollective }}" autocomplete="off" class="chooseCollective"> {{ collective.name }}
          </label>
        {% endfor %}
      </div>
    </div>
  
    <hr>
  
    <div class="row" style="overflow-x: auto;">
      <div class="btn-group btn-group-toggle" data-toggle="buttons">
        <!--
          Aqui se muestran los diferente escenarios
          las opciones deben llevar los attr-id asi como esta ahi y
          la clase chooseStage que es para manejar el evento del click cuando seleccionen uno
        -->
        {% for stage in stages.values()|sort(attribute='name') %}
          <label class="btn btn-secondary">
            <input type="radio" name="options" attr-id="{{ stage.idStages }}" autocomplete="off" class="chooseStage"> {{ stage.name }}
          </label>
        {% endfor %}
      </div>
    </div>

    <hr>

    <!--
      aqui esta el input para buscar barrio
      si o si teien que ir asi un input text y con id searchNeighborhood
      para tener el autocompletar
    -->
    <input type="text" id="searchNeighborhood">

    <hr>

    <div class="form-group">
      <label for="exampleFormControlTextarea1">Description</label>
      <!--
        aqui esta el text area para que ingrese una descripcion de lo que paso
        debe llevar el id chooseDescription
      -->
      <textarea class="form-control" rows="3" id="chooseDescription"></textarea>
    </div>

    <hr>

    <div class="row" style="overflow-x: auto;">
      <div class="btn-group btn-group-toggle" data-toggle="buttons">       
        <!--
          Aqui se muestran las opciones para seleccionar coordenadas
          la opcion ubicacion actual debe llevar clase chooseCoordinateC
          la opcion seleccionar ubicacion debe llevar la clase chooseCoordinateM
        -->
        <label class="btn btn-secondary">
          <input type="radio" name="options" autocomplete="off" class="chooseCoordinateC"> Posicion actual
        </label>
        <label class="btn btn-secondary">
          <input type="radio" name="options" autocomplete="off" class="chooseCoordinateM"> Seleccionar en mapa
        </label>
      </div>
    </div>

    <hr>
  
    <div class="row" style="overflow-x: auto;">
      <div class="btn-group btn-group-toggle" data-toggle="buttons">
        <!--
          Aqui se muestran las opciones para saber si hubo denuncia
          todas dos llevan la clase chooseComplaint
          la opcion no debe llevar el attr-id="No"
          la opcion si debe llevar el attr-id="Si"
        -->
        <label class="btn btn-secondary">
          <input type="radio" name="options" attr-id="No" autocomplete="off" class="chooseComplaint"> No
        </label>
        <label class="btn btn-secondary">
          <input type="radio" name="options" attr-id="Si" autocomplete="off" class="chooseComplaint"> Si
        </label>
      </div>
    </div>

    <hr>

    <!--
      aqui va el contador ese de cuantas respondidas lleva 
      si lo quieren poner ponen un campo con el id formFields
    -->
    <label id="formFields"></label>

    <!--
      aqui se controlan los mensajes de si si guardo o que (lo mas bonito que hice)
    -->
    {% if message == 'success' %}
      <div class="alert alert-success" role="alert">
        <strong>Reporte Creado</strong> Tu reporte ha sido creado gracias por colaborar!.
      </div>
    {% elif message == 'invalid-user' %}
      <div class="alert alert-warning" role="alert">
        <strong>Usuario no valido!</strong> Verifica tu sesion y vuelve a intentarlo!
      </div>
    {% elif message == 'error' %}
      <div class="alert alert-danger" role="alert">
        <strong>Ocurrio un error</strong> Intenta de nuevo o comunica con un administrador!
      </div>
    {% endif %}
  </div>


  <!--
    este es el formulario que verdaderamente se esta llenando
    y como esta oculto el text area que hay para la descripcion
    lo tuve que ocultar con esa clase hiddenForm
    en si esta parte no se toca solo lo de la clase hiddenForm
  -->
  <style>
    .hiddenForm {
      display: none;
    }
  </style>
  <form action="/create_report" method="POST">
    {{ report.alertType() }}
    {{ report.aggressor() }}
    {{ report.collective() }}
    {{ report.stage() }}
    {{ report.complaint() }}
    {{ report.description(class="hiddenForm") }}
    {{ report.neighborhood() }}
    {{ report.latitude() }}
    {{ report.longitude() }}
    {{ report.submit(disabled=True) }}
  </form>

  <!--
    aqui esta el modal donde la persona selecciona en el mapa donde fue que fue el asunto
    esto creeria no se toca
  -->
  <div class="modal fade" id="modalMapRpt" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Marque una psosicion</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="height: 300px;">
          <div id="mapRpt" style="width: 100%; height: 100%;"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Aceptar</button>
        </div>
      </div>
    </div>
  </div>
  <!--end REPORT FORM-->

{% endblock content %}